# Makefile for MPIP	-*-Makefile-*-
# Copyright (C) 2001 Jeffrey Vetter vetter3@llnl.gov
# $Header$

SHELL	= /bin/sh
MAKE	= make
CC	= @CC@
CXX	= @CXX@
FC	= @F77@
AR	= ar
RANLIB	= @RANLIB@
PYTHON  = python

LIBS        = @LIBS@
LDFLAGS     = @LDFLAGS@
F77_SYMBOLS = @F77_SYMBOLS@

ifneq ( $(srcdir), "." )
CPPFLAGS   += -I.
endif
CPPFLAGS    = -I$(srcdir) @CPPFLAGS@

ifdef FAST
OPT	+= -O3
endif

ifdef NODEBUG
OPT	+= 
else
OPT	+= -g
endif

OS	+= $(shell uname)
ARCH    = $(shell uname -m)

ifeq ($(OS),OSF1)
  LIBS += -lexc
endif

ifeq ($(OS),Linux)
  ifeq ($(ARCH),i686)
    CPPFLAGS += -DIA32
    LIBS += -lm
  endif
  ifeq ($(ARCH),alpha)
    CPPFLAGS += -Dalpha
  endif
  ifeq ($(ARCH),x86_64)
    CPPFLAGS += -DX86_64
  endif

endif

TARGET	 = libmpiP.a
MPIPLIB  = mpiP
FORTRAN_FLAG = @FORTRAN_FLAG@
FORTRAN_TARGET = @FORTRAN_TARGET@
MPIPFLIB = @MPIPFLIB@
F77_VENDOR = @F77_VENDOR@

DEMANGLE_TARGET =
DO_DEMANGLE = @DO_DEMANGLE@
MPIPCXXLIB  = mpiP
ifneq ($(DO_DEMANGLE),false)
  DEMANGLE_FLAG = -DDEMANGLE_$(DO_DEMANGLE)
  DEMANGLE_TARGET = libmpiPdmg.a
  MPIPCXXLIB = mpiPdmg
ifeq ($(DO_DEMANGLE),IBM)
  CPPFLAGS := -I/usr/include $(CPPFLAGS)
endif
ifeq ($(DO_DEMANGLE),Compaq)
  CPPFLAGS := -I/usr/include $(CPPFLAGS)
  CXXLIBS += -lmld
endif
endif

CFLAGS	+= ${OPT}
CPPFLAGS+= -D${OS}
LFLAGS	+=
LIBS	+=

##### EOF
