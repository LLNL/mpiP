#!/bin/sh
#
#  srun-mpip
#
#  Chris Chambreau LLNL 1/6/05
#
#  If the application has been linked against an SO MPI library and 
#  SO versions of libmpiP, libbfd, and libiberty are available, this
#  script should preload libmpiP such that MPI routines are profiled
#  and an mpiP report is generated.
#
#  This script is a wrapper for srun  The use of "srun" to run a
#  parallel job can be replaced with "srun-mpip".  
#
#  You may need to preload other objects based on your MPI implementation
#  and compiler.


MPIP_LIB_DIR=/usr/local/tools/mpiP/slib

export LD_PRELOAD=${MPIP_LIB_DIR}/libmpiP.so:/usr/lib/mpi/mpi_intel/lib/libpmpi.so:${MPIP_LIB_DIR}/libbfd.so:${MPIP_LIB_DIR}/libiberty.so:/usr/lib/mpi/lib/libpmpio.so.1.0


srun "$@"

exit $?
