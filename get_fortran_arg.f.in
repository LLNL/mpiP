! -*- Fortran -*-
!
!   @PROLOGUE@
!
!   -----
!
!   Chris Chambreau chcham@llnl.gov
!   Integrated Computing and Communications, LLNL
!   23 Jun 2004
!
!   $Header: /g/g0/chcham/CVS-depot/mpiP/get_fortran_arg.f,v 1.5 2004/10/27 18:52:48 chcham Exp $
!
!   @configure_input@
!
!   access fortran command line arguments
!

       function mpipi_get_strlen(str)
       integer i
       character str*(*)

       i = len(str)

       do while (str(i:i) .eq. ' ')
         i = i - 1
       enddo

       strlen = i
       return
       end


       subroutine mpipi_get_fortran_argc(argc_val)
       !DEC$ attributes REFERENCE :: argc_val
       integer argc_val

       argc_val = iargc()

       end 


       subroutine mpipi_get_fortran_arg(idx, buf_len, buf, len)
       !DEC$ attributes REFERENCE :: idx
       !DEC$ attributes REFERENCE :: buf_len
       !DEC$ attributes REFERENCE :: buf
       !DEC$ attributes REFERENCE :: len
       integer idx
       integer buf_len
       integer len
       integer ierr
       @FORTRAN_STR_DECL@

       @FORTRAN_GETARG@

       end 
